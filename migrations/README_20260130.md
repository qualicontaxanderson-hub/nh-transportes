# Migration 20260130 - Adicionar clienteid a funcionarios

## Problema Resolvido
A aplica√ß√£o estava falhando com erro `Unknown column 'clienteid' in 'field list'` ao acessar `/troco_pix/novo`.

## Causa
O c√≥digo estava tentando buscar a coluna `clienteid` da tabela `funcionarios`, mas essa coluna pode n√£o existir em bancos de dados antigos que n√£o executaram a migration `20260121_create_employee_management_system.sql`.

## Solu√ß√£o Implementada

### 1. C√≥digo com Fallback Gracioso ‚úÖ
O c√≥digo em `routes/troco_pix.py` foi modificado para:
- Tentar buscar com `clienteid` primeiro
- Se falhar, buscar sem `clienteid` e adicionar valor `None`
- Mant√©m compatibilidade com ambas as vers√µes do banco

**Benef√≠cio:** A aplica√ß√£o funciona IMEDIATAMENTE, mesmo sem executar migration.

### 2. Migration Idempotente (Opcional) üìã
Arquivo: `20260130_add_clienteid_to_funcionarios.sql`

Esta migration:
- Adiciona a coluna `clienteid` se ela n√£o existir
- Adiciona o √≠ndice `idx_funcionarios_cliente` se n√£o existir
- √â idempotente (pode ser executada m√∫ltiplas vezes sem erro)

**Como executar (se necess√°rio):**
```bash
mysql -h HOST -u USER -p DATABASE < migrations/20260130_add_clienteid_to_funcionarios.sql
```

## Status Atual

| Componente | Status | Descri√ß√£o |
|------------|--------|-----------|
| C√≥digo aplica√ß√£o | ‚úÖ CORRIGIDO | Funciona com e sem coluna |
| Migration dispon√≠vel | ‚úÖ CRIADA | Pronta para executar se necess√°rio |
| Deploy em produ√ß√£o | ‚úÖ SEGURO | Pode deployar sem executar migration |

## Notas
- A aplica√ß√£o funciona perfeitamente AGORA, mesmo sem a migration
- A migration √© recomendada para habilitar o filtro de frentistas por posto
- Se a coluna j√° existir, a migration n√£o faz nada (seguro)
